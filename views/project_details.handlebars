{{#each results}}

<h2><strong>Project Name:</strong> {{projectName}}</h2>
<br>
<h3><strong>Client:</strong> {{clientName}}</h3>


{{/each}}


<ul class="nav nav-tabs" role="tablist">
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType null}} active show {{/ifEquals}}" data-toggle="tab" href="#home" role="tab">Project Overview</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType 'updateProjectActivity'}}active show{{/ifEquals}}" data-toggle="tab" href="#menu2" role="tab">Project Activities</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType 'updateActionItem'}} active show {{/ifEquals}}" data-toggle="tab" href="#menu3" role="tab">KMS Action Items</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType 'updateExternalActionItem'}} active show {{/ifEquals}}" data-toggle="tab" href="#menu4" role="tab">External Action Items</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType 'updateCostSummary'}} active show {{/ifEquals}}" data-toggle="tab" href="#menu5" role="tab">Cost Summary</a>
    </li>
    <li class="nav-item">
        <a class="nav-link {{#ifEquals updateType 'updatePCO'}} active show {{/ifEquals}}" data-toggle="tab" href="#menu6" role="tab">PCO Log</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" data-toggle="tab" href="#menu7" role="tab">Client Report</a>
    </li>
</ul>

<div class="tab-content">

    <!-- Project Overview Tab -->
    {{#ifEquals updateType null}}
    <div id="home" class="tab-pane fade in active show">
    {{else}}
    <div id="home" class="tab-pane fade in">
    {{/ifEquals}}
    <br>
    <h3>Project Overview</h3>
    <br>
    <section class="row text-left">
        <div class="col-lg-3">
            {{#each results}}
            <h4 style="display: inline-block;">Client Name: </h4> &nbsp {{clientName}}
            <br> <br>
            <h4 style="display: inline-block;">Project Name: </h4> &nbsp {{projectName}}
            <br> <br>
            <h4 style="display: inline-block;">Location: </h4> &nbsp {{location}}
        </div>
        <div class="col-lg-3">
            
            <h4 style="display: inline-block;">Service Type: </h4> &nbsp {{serviceType}}
            <br> <br>
            <h4 style="display: inline-block;">Target Start Date: </h4> &nbsp {{#if targetStartDate}}{{formatDate targetStartDate}}{{/if}}
            <br> <br>
            <h4 style="display: inline-block;">Target Completion Date: </h4> &nbsp {{#if targetCompletionDate}}{{formatDate targetCompletionDate}}{{/if}}
        </div>
        <div class="col-lg-3">
            <h4 style="display: inline-block;">Projected Budget: </h4> &nbsp ${{#if projectedBudget}}{{formatNumber projectedBudget}}{{/if}}
            <br> <br>
            {{#each ../results9}}
            <h4 style="display: inline-block;">Original Contract Value: </h4> &nbsp ${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}
            <br> <br>
            <h4 style="display: inline-block;">Current Contract Value: </h4> &nbsp${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}
            {{/each}}
            {{/each}}
        </div>
        </section>
    </div>


    <!-- Project Activities Tab -->
    {{#ifEquals updateType 'updateProjectActivity'}}
    <div id="menu2" class="tab-pane fade in active show">
    {{else}}
    <div id="menu2" class="tab-pane fade in">
    {{/ifEquals}}
    <br>
    <h3>Project Activities</h3>      
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#read" role="tab">Read</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#update" role="tab">Update</a>
            </li>
        </ul>

        <!-- Tab panes -->
    <div class="tab-content">
    <div class="tab-pane active" id="read" role="tabpanel">
      <table id="projectActivityTable" class="table table-striped">
            <thead>
                <tr>
                    <th onclick="sortTable(0, 'projectActivityTable')">Activity Description</th>
                    <th onclick="sortTable(1, 'projectActivityTable')">Target Start Date</th>
                    <th onclick="sortTable(2, 'projectActivityTable')">Actual Start Date</th>
                    <th onclick="sortTable(3, 'projectActivityTable')">Target Completion Date</th>
                    <th onclick="sortTable(4, 'projectActivityTable')">Actual Completion Date</th>
                    <th onclick="sortTable(5, 'projectActivityTable')">Progress</th>
                    <th onclick="sortTable(6, 'projectActivityTable')">Activity Notes</th>
                    
                </tr>
            </thead>
            <tbody>
                {{#each results1}}
                <tr>
                    <td>{{activityDescription}}</td>
                    <td>{{#if targetStartDate}}{{formatDate targetStartDate}}{{/if}}</td>
                    <td>{{#if actualStartDate}}{{formatDate actualStartDate}}{{/if}}</td>
                    <td>{{#if targetCompletionDate}}{{formatDate targetCompletionDate}}{{/if}}</td>
                    <td>{{#if actualCompletionDate}}{{formatDate actualCompletionDate}}{{/if}}</td>
                    <td>{{#if progress}}{{progress}}{{else}}0%{{/if}}</td>
                    <td>{{activityNotes}}</td>
                </tr>
                {{/each}}
            </tbody>
        </table>
    </div>
    <div class="tab-pane" id="update" role="tabpanel">
        <br><br><h4>Add new Project Activity</h4>

        
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Activity Description</th>
                    <th>Target Start Date</th>
                    <th>Actual Start Date</th>
                    <th>Target Completion Date</th>
                    <th>Actual Completion Date</th>
                    <th>Progress</th>
                    <th>Activity Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                
                <form action="/projects/newProjectActivity" method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value={{#each results}}"{{projectID}}"{{/each}}>
                            <td>
                                <input type="text" class="form-control" id="activityDescription" name="activityDescription"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetStartDate" name="targetStartDate">
                            </td>
                            <td>
                                <input type="date" class="form-control" id="actualStartDate" name="actualStartDate"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate"> </td>
                            <td>
                                <input type="number" class="form-control" id="progress" name="progress">
                            </td>
                            <td>
                                <input type="text" class="form-control" id="activityNotes" name="activityNotes">
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update">Insert</button>
                            </td>
                    </tr>
                </form>
                
            </tbody>
        </table>
        <br><br><h4>Update Project Activity</h4>
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Activity Description</th>
                    <th>Target Start Date</th>
                    <th>Actual Start Date</th>
                    <th>Target Completion Date</th>
                    <th>Actual Completion Date</th>
                    <th>Progress</th>
                    <th>Activity Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each results1}}
                <form method="post">
                    <tr>
                        <input type="hidden" class="form-control" id="projectActivityID" name="projectActivityID" value="{{projectActivityID}}">
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value="{{projectID}}">
                            <td class="col-xs-4">
                                <input type="text" class="form-control" id="activityDescription" name="activityDescription" value="{{activityDescription}}"> 
                            </td>
                            <td>
                                <input size= "25" type="date" class="form-control" id="targetStartDate" name="targetStartDate" value="{{#if targetStartDate}}{{formatTime targetStartDate "YYYY-MM-DD"}}{{/if}}">
                            </td>
                            <td>
                                <input type="date" class="form-control" id="actualStartDate" name="actualStartDate" value="{{#if actualStartDate}}{{formatTime actualStartDate "YYYY-MM-DD"}}{{/if}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate" value="{{#if targetCompletionDate}}{{formatTime targetCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate" value="{{#if actualCompletionDate}}{{formatTime actualCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            <td class="col-xs-1">
                                <input type="number" class="form-control" id="progress" name="progress" placeholder="{{#if progress}}{{progress}}{{else}}0%{{/if}}"
                                        value="{{#if progress}}{{progress}}{{else}}0%{{/if}}">
                            </td>
                            <td class="col-xs-4"> 
                                <input type="text" class="form-control" id="activityNotes" name="activityNotes" placeholder="{{activityNotes}}" value="{{activityNotes}}"> </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update" formAction="/projects/updateProjectActivity">Update</button>
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Delete" formAction="/projects/deleteProjectActivity">Delete</button>
                            </td>
                    </tr>
                </form>
                {{/each}}
            </tbody>
        </table>
        </div>
    </div>      
    </div>
           
    {{#ifEquals updateType 'updateActionItem'}}
    <div id="menu3" class="tab-pane fade in active show">
    {{else}}
    <div id="menu3" class="tab-pane fade in">
    {{/ifEquals}}
        <br>
        <h3>KMS Action Items</h3>
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#read1" role="tab">Read</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#update1" role="tab">Update</a>
            </li>
        </ul>

    <!-- Tab panes -->
        <div class="tab-content">
            <div class="tab-pane active" id="read1" role="tabpanel">
                <table id="actionItemTable" class="table table-striped ">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0, 'actionItemTable')">Action Item Description</th>
                            <th onclick="sortTable(1, 'actionItemTable')">Actvity Owner</th>
                            <th onclick="sortTable(2, 'actionItemTable')">Activity Start Date</th>
                            <th onclick="sortTable(3, 'actionItemTable')">Target Completion Date</th>
                            <th onclick="sortTable(4, 'actionItemTable')">Actual Completion Date</th>
                            <th onclick="sortTable(5, 'actionItemTable')">Action Item Notes</th>
                        </tr>
                    </thead>
                    <tbody>

                        {{#each results2}}
                        <tr>
                            <td>{{actionItemDescription}}</td>
                            <td>{{activityOwner}}</td>
                            <td>{{#if activityStartDate}}{{formatDate activityStartDate}}{{/if}}</td>
                            <td>{{#if targetCompletionDate}}{{formatDate targetCompletionDate}}{{/if}}</td>
                            <td>{{#if actualCompletionDate}}{{formatDate actualCompletionDate}}{{/if}}</td>
                            <td>{{actionItemNotes}}</td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
            </div>
        <div class="tab-pane" id="update1" role="tabpanel">

            <br><br><h4>Add new KMS Action Item</h4>

            <table class="table table-striped ">    
                <thead>
                    <tr>
                        <th>Action Item Description</th>
                        <th>Actvity Owner</th>
                        <th>Activity Start Date</th>
                        <th>Target Completion Date</th>
                        <th>Actual Completion Date</th>
                        <th>Action Item Notes</th>
                        <th>Action</th>
                    </tr>
                </thead>
                
                <tbody>
                    <form action="/projects/newActionItem" method="post">
                        <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value={{#each results}}"{{projectID}}"{{/each}}>
                            <td>
                                <input type="text" class="form-control" id="actionItemDescription" name="actionItemDescription"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="activityOwner" name="activityOwner">
                            </td>
                            <td>
                                <input type="date" class="form-control" id="activityStartDate" name="activityStartDate"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate"> </td>
                            <td>
                                <input type="text" class="form-control" id="actionItemNotes" name="actionItemNotes">
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update">Insert</button>
                            </td>
                    </tr>
                </form>
                
            </tbody>
        </table>
        <br><br><h4>Update KMS Action Item</h4>
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Action Item Description</th>
                    <th>Actvity Owner</th>
                    <th>Activity Start Date</th>
                    <th>Target Completion Date</th>
                    <th>Actual Completion Date</th>
                    <th>Action Item Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each results2}}
                <form method="post">
                    <tr>
                        <input type="hidden" class="form-control" id="kmsActionItemID" name="kmsActionItemID" value="{{kmsActionItemID}}">
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value="{{projectID}}">
                            <td>
                                <input type="text" class="form-control" id="actionItemDescription" name="actionItemDescription" value="{{actionItemDescription}}"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="activityOwner" name="activityOwner" value="{{activityOwner}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="activityStartDate" name="activityStartDate" value="{{#if activityStartDate}}{{formatTime activityStartDate "YYYY-MM-DD"}}{{/if}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate" value="{{#if targetCompletionDate}}{{formatTime targetCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate" value="{{#if actualCompletionDate}}{{formatTime actualCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            
                            <td>
                                <input type="text" class="form-control" id="actionItemNotes" name="actionItemNotes"  value="{{actionItemNotes}}"> 
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update" formAction="/projects/updateActionItem">Update</button>
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Delete" formAction="/projects/deleteActionItem">Delete</button>
                            </td>
                    </tr>
                </form>
                {{/each}}
            </tbody>
        </table>
        </div>
    </div>
                

            </div>
            {{#ifEquals updateType 'updateExternalActionItem'}}
            <div id="menu4" class="tab-pane fade in active show">
            {{else}}
            <div id="menu4" class="tab-pane fade in">
            {{/ifEquals}}
                <br>
                <h3>External Action Items</h3>

                <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#read2" role="tab">Read</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#update2" role="tab">Update</a>
            </li>
        </ul>

    <!-- Tab panes -->
    <div class="tab-content">
    <div class="tab-pane active" id="read2" role="tabpanel">
      <table id="externalActionItemTable" class="table table-striped ">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0, 'externalActionItemTable')">Action Item Description</th>
                            <th onclick="sortTable(1, 'externalActionItemTable')">Actvity Owner</th>
                            <th onclick="sortTable(2, 'externalActionItemTable')">Activity Start Date</th>
                            <th onclick="sortTable(3, 'externalActionItemTable')">Target Completion Date</th>
                            <th onclick="sortTable(4, 'externalActionItemTable')">Actual Completion Date</th>
                            <th onclick="sortTable(5, 'externalActionItemTable')">Action Item Notes</th>
                        </tr>
                    </thead>
                    <tbody>

                        {{#each results3}}
                        <tr>
                            <td>{{actionItemDescription}}</td>
                            <td>{{activityOwner}}</td>
                            <td>{{#if activityStartDate}}{{formatDate activityStartDate}}{{/if}}</td>
                            <td>{{#if targetCompletionDate}}{{formatDate targetCompletionDate}}{{/if}}</td>
                            <td>{{#if actualCompletionDate}}{{formatDate actualCompletionDate}}{{/if}}</td>
                            <td>{{actionItemNotes}}</td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
    </div>
    <div class="tab-pane" id="update2" role="tabpanel">
        <br><br><h4>Add new External Action Item</h4>

        
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Action Item Description</th>
                    <th>Actvity Owner</th>
                    <th>Activity Start Date</th>
                    <th>Target Completion Date</th>
                    <th>Actual Completion Date</th>
                    <th>Action Item Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                
                <form action="/projects/newExternalActionItem" method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value={{#each results}}"{{projectID}}"{{/each}}>
                            <td>
                                <input type="text" class="form-control" id="actionItemDescription" name="actionItemDescription"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="activityOwner" name="activityOwner">
                            </td>
                            <td>
                                <input type="date" class="form-control" id="activityStartDate" name="actualStartDate"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate"> </td>
                            <td>
                                <input type="text" class="form-control" id="actionItemNotes" name="actionItemNotes">
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update">Insert</button>
                            </td>
                    </tr>
                </form>
                
            </tbody>
        </table>
        <br><br><h4>Update External Action Item</h4>
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Action Item Description</th>
                    <th>Actvity Owner</th>
                    <th>Activity Start Date</th>
                    <th>Target Completion Date</th>
                    <th>Actual Completion Date</th>
                    <th>Action Item Notes</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each results3}}
                <form method="post">
                    <tr>
                        <input type="hidden" class="form-control" id="externalActionItem" name="externalActionItemID" value="{{externalActionItemID}}">
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value="{{projectID}}">
                            <td>
                                <input type="text" class="form-control" id="actionItemDescription" name="actionItemDescription" value="{{actionItemDescription}}"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="activityOwner" name="activityOwner" value="{{activityOwner}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="activityStartDate" name="activityStartDate" value="{{#if activityStartDate}}{{formatTime activityStartDate "YYYY-MM-DD"}}{{/if}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="targetCompletionDate" name="targetCompletionDate" value="{{#if targetCompletionDate}}{{formatTime targetCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            <td>
                                <input type="date" class="form-control" id="actualCompletionDate" name="actualCompletionDate" value="{{#if actualCompletionDate}}{{formatTime actualCompletionDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            
                            <td>
                                <input type="text" class="form-control" id="actionItemNotes" name="actionItemNotes"  value="{{actionItemNotes}}"> 
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update" formAction="/projects/updateExternalActionItem">Update</button>
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Delete" formAction="/projects/deleteExternalActionItem">Delete</button>
                            </td>
                    </tr>
                </form>
                {{/each}}
            </tbody>
        </table>
        </div>
    </div>
    </div>
    {{#ifEquals updateType 'updateCostSummary'}}
            <div id="menu5" class="tab-pane fade in active show">
            {{else}}
            <div id="menu5" class="tab-pane fade in">
            {{/ifEquals}}
                <br>
                <h3>Cost Summary</h3>

                <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#read3" role="tab">Read</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#update3" role="tab">Update</a>
            </li>           
        </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        <div class="tab-pane active" id="read3" role="tabpanel">
        {{#each results6}} 

        {{#ifEquals orderSet 0}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Allowances'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Allowances'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 1}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'FF&E'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'FF&E'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 2}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'IT'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'IT'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'IT'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 3}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Security'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Security'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Security'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 4}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Consultants'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Consultants'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 5}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Contingency'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Contingency'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 6}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Owner Supplied Equipment'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}

        {{#ifEquals orderSet 7}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            
            <tbody>
            
            {{#each ../results4}}
            <tr>
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}}
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
            </tr>
            {{/each}}

            <tr  class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 1 - General Conditions and Insurance'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                {{/each}}
            </tr>

            </tbody>
        </table>
        {{/ifEquals}}


        {{#ifEquals orderSet 8}}
        <br>
        <strong>{{divisionCategory}}</strong>
        <br>
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Revised Contract Value</th>
                    <th>Variance</th>
                    <th>Actual Cost To Date</th>
                    <th>Remaining Contract Value</th>
                </tr>
            </thead>
            <tbody>
            {{#each ../results4}}
                <tr>
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
                    {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
                </tr>
            {{/each}}

            <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 2 - Site Construction'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

            </tbody>
        </table>
{{/ifEquals}}
{{#ifEquals orderSet 9}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}}
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 3 - Concrete'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>
    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 10}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 4 - Masonry'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 11}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 5 - Metals'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>
    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 12}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 6 - Carpentry and Millwork'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 13}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 7 - Thermal and Moisture Protection'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 14}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 8 - Doors and Windows'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 15}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 9 - Finishes'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 16}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 10 - Specialties'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 17}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 11 - Equipment'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 18}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 12 - Furnishings'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 19}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 13 - Special Construction'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>

    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 20}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 14 - Conveying Systems'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>
    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 21}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_budget}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_changeOrders}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_variance}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}
            <td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}} 
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>
    </tbody>
</table>
{{/ifEquals}}
{{#ifEquals orderSet 22}}
<br>
<strong>{{divisionCategory}}</strong>
<br>
<table class="table table-striped ">
    <thead>
        <tr>
            <th>Line Item</th>
            <th>Budget</th>
            <th>Original Contract Value</th>
            <th>Change Orders</th>
            <th>Revised Contract Value</th>
            <th>Variance</th>
            <th>Actual Cost To Date</th>
            <th>Remaining Contract Value</th>
        </tr>
    </thead>
    <tbody>

        {{#each ../results4}}
        <tr>
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>{{lineitem_lineItemBreakdown}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_budget}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_originalContractValue}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_changeOrders}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_revisedContractValue}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_variance}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_actualCostToDate}}</td>{{/ifEquals}} 
            {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}}<td>${{lineitem_remainingContractValue}}</td>{{/ifEquals}}
        </tr>
        {{/each}}

        <tr class="table-info">
                {{#each ../results8}}
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>Subtotal:</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if budget}}{{formatNumber budget}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if originalContractValue}}{{formatNumber originalContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if changeOrders}}{{formatNumber changeOrders}}{{/if}}</strong></td>{{/ifEquals}}
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if revisedContractValue}}{{formatNumber revisedContractValue}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if variance}}{{formatNumber variance}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if actualCostToDate}}{{formatNumber actualCostToDate}}{{/if}}</strong></td>{{/ifEquals}} 
                {{#ifEquals divisionCategory 'Division 16 - Electrical'}}<td><strong>${{#if remainingContractValue}}{{formatNumber remainingContractValue}}{{/if}}</strong></td>{{/ifEquals}}
                
                {{/each}}
            </tr>
    </tbody>
</table>
{{/ifEquals}}
 {{/each}}
    </div>
     
    <div class="tab-pane" id="update3" role="tabpanel">
        <br><br><h4>Add new Cost Sumary Line Item</h4>

        
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>Division Category</th>
                    <th>Line Item</th>
                    <th>Budget</th>
                    <th>Original Contract Value</th>
                    <th>Change Orders</th>
                    <th>Actual Cost To Date</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                
                <form action="/projects/newCostSummary" method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value={{#each results}}"{{projectID}}"{{/each}}>                          
                            <td>
                                <select class="form-control" name="divisionCategory" id="divisionCategory">
                                    <option value="Allowances">Allowances</option>
                                    <option value="FF&E">FF&E</option>
                                    <option value="IT">IT</option>
                                    <option value="Security">Security</option>
                                    <option value="Consultants">Consultants</option>
                                    <option value="Contingency">Contingency</option>
                                    <option value="Owner Supplied Equipment">Owner Supplied Equipment</option>
                                    <option value="Division 1 - General Conditions & Insurance">Division 1 - General Conditions & Insurance</option>
                                    <option value="Division 2 - Site Construction">Division 2 - Site Construction</option>
                                    <option value="Division 3 - Concrete">Division 3 - Concrete</option>
                                    <option value="Division 4 - Masonry">Division 4 - Masonry</option>
                                    <option value="Division 5 - Metals">Division 5 - Metals</option>
                                    <option value="Division 6 - Carpentry and Millwork">Division 6 - Carpentry and Millwork</option>
                                    <option value="Division 7 - Thermal and Moisture Protection">Division 7 - Thermal and Moisture Protection</option>
                                    <option value="Division 8 - Doors and Windows">Division 8 - Doors and Windows</option>
                                    <option value="Division 9 - Finishes">Division 9 - Finishes</option>
                                    <option value="Division 10 - Specialties">Division 10 - Specialties</option>
                                    <option value="Division 11 - Equipment">Division 11 - Equipment</option>
                                    <option value="Division 12 - Furnishings">Division 12 - Furnishings</option>
                                    <option value="Division 13 - Special Construction">Division 13 - Special Construction</option>
                                    <option value="Division 14 - Conveying Systems">Division 14 - Conveying Systems</option>
                                    <option value="Division 15 - Mechanical, Plumbing, HVAC, and Fire">Division 15 - Mechanical, Plumbing, HVAC, and Fire</option>
                                    <option value="Division 16 - Electrical">Division 16 - Electrical</option>
                                </select>
                            </td>
                            <td>
                                <input type="text" class="form-control" id="lineItemBreakdown" name="lineItemBreakdown" value="{{lineItemBreakdown}}">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="budget" name="budget" value="{{budget}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="originalContractValue" name="originalContractValue" value="{{originalContractValue}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="changeOrders" name="changeOrders" value="{{changeOrders}}">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="actualCostToDate" name="actualCostToDate" value="{{actualCostToDate}}">
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update">Insert</button>
                            </td>
                    </tr>
                </form>
                
            </tbody>
        </table>
        <br><br><h4>Update Cost Sumary Line Item</h4>
        <table class="table table-striped ">
                    <thead>
                        <tr>
                            <th>Division Category</th>
                            <th>Line Item</th>
                            <th>Budget</th>
                            <th>Original Contract Value</th>
                            <th>Change Orders</th>
                            <th>Actual Cost To Date</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                {{#each results4}}
                <form method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value="{{lineitem_projectID}}">
                        <input type="hidden" class="form-control" id="lineItemID" name="lineItemID" value={{lineitem_lineItemID}}>
                            <td>
                                <select class="form-control" name="divisionCategory" id="divisionCategory">
                                    <option value="Allowances" {{#ifEquals lineitem_divisionCategory 'Allowances'}} selected {{/ifEquals}}>Allowances</option>
                                    <option value="FF&E" {{#ifEquals lineitem_divisionCategory 'FF&E'}} selected {{/ifEquals}}>FF&E</option>
                                    <option value="IT" {{#ifEquals lineitem_divisionCategory 'IT'}} selected {{/ifEquals}}>IT</option>
                                    <option value="Security" {{#ifEquals lineitem_divisionCategory 'Security'}} selected {{/ifEquals}}>Security</option>
                                    <option value="Consultants" {{#ifEquals lineitem_divisionCategory 'Consultants'}} selected {{/ifEquals}}>Consultants</option>
                                    <option value="Contingency" {{#ifEquals lineitem_divisionCategory 'Contingency'}} selected {{/ifEquals}}>Contingency</option>
                                    <option value="Owner Supplied Equipment" {{#ifEquals lineitem_divisionCategory 'Owner Supplied Equipment'}} selected {{/ifEquals}}>Owner Supplied Equipment</option>
                                    <option value="Division 1 - General Conditions and Insurance" {{#ifEquals lineitem_divisionCategory 'Division 1 - General Conditions and Insurance'}} selected {{/ifEquals}}>Division 1 - General Conditions and Insurance</option>
                                    <option value="Division 2 - Site Construction" {{#ifEquals lineitem_divisionCategory 'Division 2 - Site Construction'}} selected {{/ifEquals}}>Division 2 - Site Construction</option>
                                    <option value="Division 3 - Concrete" {{#ifEquals lineitem_divisionCategory 'Division 3 - Concrete'}} selected {{/ifEquals}}>Division 3 - Concrete</option>
                                    <option value="Division 4 - Masonry" {{#ifEquals lineitem_divisionCategory 'Division 4 - Masonry'}} selected {{/ifEquals}}>Division 4 - Masonry</option>
                                    <option value="Division 5 - Metals" {{#ifEquals lineitem_divisionCategory 'Division 5 - Metals'}} selected {{/ifEquals}}>Division 5 - Metals</option>
                                    <option value="Division 6 - Carpentry and Millwork" {{#ifEquals lineitem_divisionCategory 'Division 6 - Carpentry and Millwork'}} selected {{/ifEquals}}>Division 6 - Carpentry and Millwork</option>
                                    <option value="Division 7 - Thermal and Moisture Protection" {{#ifEquals lineitem_divisionCategory 'Division 7 - Thermal and Moisture Protection'}} selected {{/ifEquals}}>Division 7 - Thermal and Moisture Protection</option>
                                    <option value="Division 8 - Doors and Windows" {{#ifEquals lineitem_divisionCategory 'Division 8 - Doors and Windows'}} selected {{/ifEquals}}>Division 8 - Doors and Windows</option>
                                    <option value="Division 9 - Finishes" {{#ifEquals lineitem_divisionCategory 'Division 9 - Finishes'}} selected {{/ifEquals}}>Division 9 - Finishes</option>
                                    <option value="Division 10 - Specialties" {{#ifEquals lineitem_divisionCategory 'Division 10 - Specialties'}} selected {{/ifEquals}}>Division 10 - Specialties</option>
                                    <option value="Division 11 - Equipment" {{#ifEquals lineitem_divisionCategory 'Division 11 - Equipment'}} selected {{/ifEquals}}>Division 11 - Equipment</option>
                                    <option value="Division 12 - Furnishings" {{#ifEquals lineitem_divisionCategory 'Division 12 - Furnishings'}} selected {{/ifEquals}}>Division 12 - Furnishings</option>
                                    <option value="Division 13 - Special Construction" {{#ifEquals lineitem_divisionCategory 'Division 13 - Special Construction'}} selected {{/ifEquals}}>Division 13 - Special Construction</option>
                                    <option value="Division 14 - Conveying Systems" {{#ifEquals lineitem_divisionCategory 'Division 14 - Conveying Systems'}} selected {{/ifEquals}}>Division 14 - Conveying Systems</option>
                                    <option value="Division 15 - Mechanical, Plumbing, HVAC, and Fire" {{#ifEquals lineitem_divisionCategory 'Division 15 - Mechanical, Plumbing, HVAC, and Fire'}} selected {{/ifEquals}}>Division 15 - Mechanical, Plumbing, HVAC, and Fire</option>
                                    <option value="Division 16 - Electrical" {{#ifEquals lineitem_divisionCategory 'Division 16 - Electrical'}} selected {{/ifEquals}}>Division 16 - Electrical</option>
                                </select>
                            </td>
                            <td>
                                <input type="text" class="form-control" id="lineItemBreakdown" name="lineItemBreakdown" value="{{lineitem_lineItemBreakdown}}">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="budget" name="budget" value="{{lineitem_budget}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="originalContractValue" name="originalContractValue" value="{{lineitem_originalContractValue}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="changeOrders" name="changeOrders" value="{{lineitem_changeOrders}}">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="actualCostToDate" name="actualCostToDate" value="{{lineitem_actualCostToDate}}">
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update" formAction="/projects/updateCostSummary">Update</button>
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Delete" formAction="/projects/deleteCostSummary">Delete</button>
                            </td>
                    </tr>
                </form>
                {{/each}}
            </tbody>
            </table>
        </div>
    
            {{#ifEquals updateType 'updatePCO'}}
            <div id="menu6" class="tab-pane fade in active show">
            {{else}}
            <div id="menu6" class="tab-pane fade in">
            {{/ifEquals}}
                <br>
                <h3>PCO Log</h3>

                <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#read4" role="tab">Read</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#update4" role="tab">Update</a>
            </li>
        </ul>

    <!-- Tab panes -->
    <div class="tab-content">
    <div class="tab-pane active" id="read4" role="tabpanel">
      <table id="pcoTable" class="table table-striped ">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0, 'pcoTable')">PCO Number</th>
                            <th onclick="sortTable(1, 'pcoTable')">PCO Description</th>
                            <th onclick="sortTable(2, 'pcoTable')">Due Date</th>
                            <th onclick="sortTable(3, 'pcoTable')">To KMS Date</th>
                            <th onclick="sortTable(4, 'pcoTable')">KMS Reviewed Date</th>
                            <th onclick="sortTable(5, 'pcoTable')">Bank Approved Date</th>
                            <th onclick="sortTable(6, 'pcoTable')">PCO Value</th>
                            <th onclick="sortTable(7, 'pcoTable')">Contingency Amount</th>
                            <th onclick="sortTable(8, 'pcoTable')">Cost Savings Amount</th>
                            <th onclick="sortTable(9, 'pcoTable')">Change Orders</th>
                            <th onclick="sortTable(10, 'pcoTable')">Status</th>
                            <th onclick="sortTable(11, 'pcoTable')">Comments</th>
                        </tr>
                    </thead>
                    <tbody>

                        {{#each results5}}
                        <tr>
                            <td>{{pcoNumber}}</td>
                            <td>{{pcoDescription}}</td>
                            <td>{{#if dueDate}}{{formatDate dueDate}}{{/if}}</td>
                            <td>{{#if toKMSDate}}{{formatDate toKMSDate}}{{/if}}</td>
                            <td>{{#if kmsReviewedDate}}{{formatDate kmsReviewedDate}}{{/if}}</td>
                            <td>{{#if clientApprovedDate}}{{formatDate clientApprovedDate}}{{/if}}</td>
                            <td>${{pcoValue}}</td>
                            <td>${{contingencyAmount}}</td>
                            <td>${{costSavingsAmount}}</td>
                            <td>{{changeOrders}}</td>
                            <td>{{pcoStatus}}</td>
                            <td>{{comments}}</td>
                        </tr>
                        {{/each}}
                    </tbody>
                </table>
    </div>
    <div class="tab-pane" id="update4" role="tabpanel">
        <br><br><h4>Add new PCO</h4>

        
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>PCO Number</th>
                    <th>PCO Description</th>
                    <th>Due Date</th>
                    <th>To KMS Date</th>
                    <th>KMS Reviewed Date</th>
                    <th>Client Approved Date</th>
                    <th>PCO Value</th>
                    <th>Contingency Amount</th>
                    <th>Cost Savings Amount</th>
                    <th>Change Orders</th>
                    <th>Status</th>
                    <th>Comments</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                
                <form action="/projects/newPCO" method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value={{#each results}}"{{projectID}}"{{/each}}>
                            <td>
                                <input type="text" class="form-control" id="pcoNumber" name="pcoNumber"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="pcoDescription" name="pcoDescription"> 
                            </td>
                            <td>
                                <input type="date" id="dueDate" name="dueDate">
                            </td>
                            <td>
                                <input type="date" id="toKMSDate" name="toKMSDate"> 
                            </td>
                            <td>
                                <input type="date" id="kmsReviewedDate" name="kmsReviewedDate"> </td>
                            <td>
                                <input type="date" id="clientApprovedDate" name="clientApprovedDate"> </td>
                            <td>
                                <input type="number" class="form-control" id="pcoValue" name="pcoValue">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="contingencyAmount" name="contingencyAmount">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="costSavingsAmount" name="costSavingsAmount">
                            </td>
                            <td>
                                <input type="number" class="form-control" id="changeOrders" name="changeOrders">
                            </td>
                            <td>
                                <input type="text" class="form-control" id="pcoStatus" name="pcoStatus">
                            </td>
                            <td>
                                <input type="text" class="form-control" id="comments" name="comments">
                            </td>
                            
                            <td>
                                
                                <button type="submit" name="actionType" class="form-control" value="Update">Insert</button>
                            </td>
                    </tr>
                </form>
                
            </tbody>
        </table>
        <br><br><h4>Update PCO</h4>
        <table class="table table-striped ">
            <thead>
                <tr>
                    <th>PCO Number</th>
                            <th>PCO Description</th>
                            <th>Due Date</th>
                            <th>To KMS Date</th>
                            <th>KMS Reviewed Date</th>
                            <th>Client Approved Date</th>
                            <th>PCO Value</th>
                            <th>Contingency Amount</th>
                            <th>Cost Savings Amount</th>
                            <th>Change Orders</th>
                            <th>Status</th>
                            <th>Comments</th>
                            <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {{#each results5}}
                <form method="post">
                    <tr>
                        
                        <input type="hidden" class="form-control" id="projectID" name="projectID" value="{{projectID}}">
                        <input type="hidden" class="form-control" id="pcoID" name="pcoID" value="{{pcoID}}">
                            <td>
                                <input type="text" class="form-control" id="pcoNumber" name="pcoNumber" value="{{pcoNumber}}" readonly>
                            </td>
                            <td>
                                <input type="text" class="form-control" id="pcoDescription" name="pcoDescription" value="{{pcoDescription}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="dueDate" name="dueDate" value="{{#if dueDate}}{{formatTime dueDate "YYYY-MM-DD"}}{{/if}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="toKMSDate" name="toKMSDate" value="{{#if toKMSDate}}{{formatTime toKMSDate "YYYY-MM-DD"}}{{/if}}"> 
                            </td>
                            <td>
                                <input type="date" class="form-control" id="kmsReviewedDate" name="kmsReviewedDate" value="{{#if kmsReviewedDate}}{{formatTime kmsReviewedDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            <td>
                                <input type="date" class="form-control" id="clientApprovedDate" name="clientApprovedDate" value="{{#if clientApprovedDate}}{{formatTime clientApprovedDate "YYYY-MM-DD"}}{{/if}}"> </td>
                            
                            <td>
                                <input type="number" class="form-control" id="pcoValue" name="pcoValue" value="{{pcoValue}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="contingencyAmount" name="contingencyAmount" value="{{contingencyAmount}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="costSavingsAmount" name="costSavingsAmount" value="{{costSavingsAmount}}"> 
                            </td>
                            <td>
                                <input type="number" class="form-control" id="changeOrders" name="changeOrders" value="{{changeOrders}}"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="pcoStatus" name="pcoStatus" value="{{pcoStatus}}"> 
                            </td>
                            <td>
                                <input type="text" class="form-control" id="comments" name="comments" value="{{comments}}"> 
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Update" formAction="/projects/updatePCO">Update</button>
                            </td>
                            <td>
                                <button type="submit" name="actionType" class="form-control" value="Delete" formAction="/projects/deletePCO">Delete</button>
                            </td>
                    </tr>
                </form>
                {{/each}}
            </tbody>
        </table>
        </div>
    </div>
    </div>

            <div id="menu7" class="tab-pane fade container-fluid flyer-builder">

            <br><p><i>For images, use JPG / JPEG.</i></p>

		    <div class="row">
				<div class="col-sm-7 loc_form">
						<div class="row">
							<div class="col-sm-6">
								<label for="flyer-image" class="control-label">Client Logo</label>
								<input id="flyer-image" type="file" tabindex="1">
							</div>
							
							<div class="col-sm-6">
								<label for="flyer-frequency" class="control-label">Frequency</label><br>
								<input id="flyer-frequency" type="radio" name="freq" value="Weekly" checked tabindex="2"> Weekly
  								<input id="flyer-frequency" type="radio" name="freq" value="Bi-Weekly"> Bi-Weekly
								<input id="flyer-frequency" type="radio" name="freq" value="Monthly"> Monthly
								<input id="flyer-frequency" type="radio" name="freq" value="Yearly"> Yearly
							</div>
						</div>

						<br>
{{!--
						<div class="row">
								<div class="col-sm-3">
										<label class="control-label" for="flyer-projectid">Project ID</label>
										<input required class="form-control" id="flyer-projectid" placeholder="" maxlength="5" type="text">
								</div>
						</div>
--}}
						<div class="form-group">
								<label class="control-label" for="flyer-description">Executive Summary</label>
								<textarea class="form-control" id="flyer-description" rows="3" placeholder="Insert executive summary here." tabindex="3"></textarea>
						</div>
{{!--
						<div class="row">
								<div class="col-sm-3">
										<div class="form-group">
												<label for="flyer-price-currency" class="control-label">Currency</label>
												<select required class="form-control" id="flyer-price-currency" tabindex="6">
														<option value="$">$</option>
												</select>
										</div>
								</div>
						</div>
--}}
                    <!-- Quality Section -->
						<div class="form-group">
								<label class="control-label" for="flyer-quality">Quality Summary</label>
								<textarea class="form-control" id="flyer-quality" rows="3" placeholder="Insert quality summary here." tabindex="4"></textarea>
						</div>

						<div class="row">
							<div class="col-sm-3">
									<label for="flyer-quality1" class="control-label">Quality Image 1</label>
									<input id="flyer-quality1" type="file" tabindex="5" multiple>
									<input type="text" id="Q1_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality2" class="control-label">Quality Image 2</label>
									<input id="flyer-quality2" type="file" tabindex="6">
									<input type="text" id="Q2_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality3" class="control-label">Quality Image 3</label>
									<input id="flyer-quality3" type="file" tabindex="5">
									<input type="text" id="Q3_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality4" class="control-label">Quality Image 4</label>
									<input id="flyer-quality4" type="file" tabindex="5">
									<input type="text" id="Q4_c" placeholder="Caption" maxlength="230">
							</div>
						</div>

						<div class="row">
							<div class="col-sm-3">
									<label for="flyer-quality5" class="control-label">Quality Image 5</label>
									<input id="flyer-quality5" type="file" tabindex="5">
									<input type="text" id="Q5_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality6" class="control-label">Quality Image 6</label>
									<input id="flyer-quality6" type="file" tabindex="6">
									<input type="text" id="Q6_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality7" class="control-label">Quality Image 7</label>
									<input id="flyer-quality7" type="file" tabindex="6">
									<input type="text" id="Q7_c" placeholder="Caption" maxlength="230">
							</div>

							<div class="col-sm-3">
									<label for="flyer-quality8" class="control-label">Quality Image 8</label>
									<input id="flyer-quality8" type="file" tabindex="6">
									<input type="text" id="Q8_c" placeholder="Caption" maxlength="230">
							</div>
						</div>

						<br>

						<div class="form-group">
								<label class="control-label" for="flyer-quality-notes">Quality Image Notes</label>
								<textarea class="form-control" id="flyer-quality-notes" rows="3" placeholder="Insert notes on quality images here." tabindex="6"></textarea>
						</div>

                    <!-- Construction Progress Section -->
                        <div class="row">
                            <div class="col-sm-3">
                                    <label for="flyer-construction1" class="control-label">Construction Image 1</label>
                                    <input id="flyer-construction1" type="file" tabindex="5" multiple>
                                    <input type="text" id="C1_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction2" class="control-label">Construction Image 2</label>
                                    <input id="flyer-construction2" type="file" tabindex="6">
                                    <input type="text" id="C2_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction3" class="control-label">Construction Image 3</label>
                                    <input id="flyer-construction3" type="file" tabindex="5">
                                    <input type="text" id="C3_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction4" class="control-label">Construction Image 4</label>
                                    <input id="flyer-construction4" type="file" tabindex="5">
                                    <input type="text" id="C4_c" placeholder="Caption" maxlength="230">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-3">
                                    <label for="flyer-construction5" class="control-label">Construction Image 5</label>
                                    <input id="flyer-construction5" type="file" tabindex="5">
                                    <input type="text" id="C5_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction6" class="control-label">Construction Image 6</label>
                                    <input id="flyer-construction6" type="file" tabindex="6">
                                    <input type="text" id="C6_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction7" class="control-label">Construction Image 7</label>
                                    <input id="flyer-construction7" type="file" tabindex="6">
                                    <input type="text" id="C7_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction8" class="control-label">Construction Image 8</label>
                                    <input id="flyer-construction8" type="file" tabindex="6">
                                    <input type="text" id="C8_c" placeholder="Caption" maxlength="230">
                            </div>
                        </div>

                        <br>
                        <div class="row">
                            <div class="col-sm-3">
                                    <label for="flyer-construction9" class="control-label">Construction Image 9</label>
                                    <input id="flyer-construction9" type="file" tabindex="5" multiple>
                                    <input type="text" id="C9_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction10" class="control-label">Construction Image 10</label>
                                    <input id="flyer-construction10" type="file" tabindex="6">
                                    <input type="text" id="C10_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction11" class="control-label">Construction Image 11</label>
                                    <input id="flyer-construction11" type="file" tabindex="5">
                                    <input type="text" id="C11_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction12" class="control-label">Construction Image 12</label>
                                    <input id="flyer-construction12" type="file" tabindex="5">
                                    <input type="text" id="C12_c" placeholder="Caption" maxlength="230">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-3">
                                    <label for="flyer-construction13" class="control-label">Construction Image 13</label>
                                    <input id="flyer-construction13" type="file" tabindex="5">
                                    <input type="text" id="C13_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction14" class="control-label">Construction Image 14</label>
                                    <input id="flyer-construction14" type="file" tabindex="6">
                                    <input type="text" id="C14_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction15" class="control-label">Construction Image 15</label>
                                    <input id="flyer-construction15" type="file" tabindex="6">
                                    <input type="text" id="C15_c" placeholder="Caption" maxlength="230">
                            </div>

                            <div class="col-sm-3">
                                    <label for="flyer-construction16" class="control-label">Construction Image 16</label>
                                    <input id="flyer-construction16" type="file" tabindex="6">
                                    <input type="text" id="C16_c" placeholder="Caption" maxlength="230">
                            </div>
                        </div>

                        <br>
                        <div class="form-group">
								<label class="control-label" for="flyer-construction-extra">Link to Construction Image Album</label>
								<input class="form-control" id="flyer-construction-extra" placeholder="Insert link to image album if number of images exceeds available input fields."></input>
						</div>

						<hr>

                    <!-- Non-visible page elements used in PDF -->
                        <div style="display:none">
                            {{#each results}}
                            <form method="post">
                            <textarea class="form-control" id="client_name">{{clientName}}</textarea>
                            </form>
                            {{/each}}
                        </div>

						<div id="table" style="visibility:collapse">
						<table class="table table-striped">
                   			<thead>
                        	<tr><th>First Name</th><th>Last Name</th><th>Email</th><th>Phone Number</th><th>Permission Level</th></tr>
                    		</thead>    
            				
							<tbody>
                			{{#each results0}}
                			<form method="post">
                    			<tr>
                        			<td>{{firstName}}</td>
                        			<td>{{lastName}}</td>
                        			<td>{{email}}</td>
                        			<td>{{cellNumber}}</td>
                        			<td>{{permissionLevel}}</td>
                    			</tr>
                			</form>
                			{{/each}}
            				</tbody>
        					</table>
						</div>

						<div class="row">
                            <!--
								<div class="col-sm-3">
										<div class="form-group">
												<button id="flyer_quality_btn" type="button" class="btn btn-info btn-block" tabindex="8">More Quality Images</button>
										</div>
								</div>

								<div class="col-sm-3">
										<div class="form-group">
												<button id="flyer_progress_btn" type="button" class="btn btn-info btn-block" tabindex="8">More Progress Images</button>
										</div>
								</div>
                            -->
								<div class="col-sm-6">
										<div class="form-group">
												<button id="flyer_preview_btn" type="button" class="btn btn-primary btn-block" tabindex="9">Update Preview</button>
										</div>
								</div>

								<div class="col-sm-6">
										<div class="form-group text-right">
												<button id="flyer_download_btn" type="button" class="btn btn-success btn-xs btn-block" tabindex="10">Download</button>
										</div>
								</div>
						</div>

				</div>

				<div class="col-sm-5">
						<iframe id="pdf_preview" type="application/pdf" src=""></iframe>
				</div>

		</div>

            </div>
        </div>
    </div>
</div>

<script src="handlebars/dist/handlebars.min.js"></script>
<script src="handlebars-intl/dist/handlebars-intl.min.js"></script>

<script type="text/javascript">
function sortTable(n, tableUsed) { 
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById(tableUsed.toString());
  switching = true;
  //Set the sorting direction to ascending:
  dir = "asc"; 
  /*Make a loop that will continue until
  no switching has been done:*/
  while (switching) {
    //start by saying: no switching is done:
    switching = false;
    rows = table.getElementsByTagName("TR");
    /*Loop through all table rows (except the
    first, which contains table headers):*/
    for (i = 1; i < (rows.length - 1); i++) {
      //start by saying there should be no switching:
      shouldSwitch = false;
      /*Get the two elements you want to compare,
      one from current row and one from the next:*/
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /*check if the two rows should switch place,
      based on the direction, asc or desc:*/
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          //if so, mark as a switch and break the loop:
          shouldSwitch= true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      /*If a switch has been marked, make the switch
      and mark that a switch has been done:*/
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      //Each time a switch is done, increase this count by 1:
      switchcount ++;      
    } else {
      /*If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again.*/
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}
</script>

<script src="https://code.jquery.com/jquery-3.0.0.js"></script>
<script src="https://code.jquery.com/jquery-migrate-3.0.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.debug.js" integrity="sha384-CchuzHs077vGtfhGYl9Qtc7Vx64rXBXdIAZIPbItbNyWIRTdG0oYAqki3Ry13Yzu" crossorigin="anonymous"></script> {{!-- jsPDF base --}}

{{!-- Form Builder --}}
<script type="text/javascript">
/* jshint undef:false, newcap: false, unused:false */

(function(API){
    API.textAlign = function(txt, options, x, y) {
        options = options ||{};

		// Get current font size
        var fontSize = this.internal.getFontSize();

        // Get page width
        var pageWidth = this.internal.pageSize.width;

        var txtWidth = this.getStringUnitWidth(txt)*fontSize/this.internal.scaleFactor;

        if( options.align === "center" ){

            // Calculate text's x coordinate
            x = ( pageWidth - txtWidth ) / 2;

        } else if( options.align === "centerAtX" ){ // center on X value

	        x = x - (txtWidth/2);

        } else if(options.align === "right") {

	        x = x - txtWidth;
        }

        // Draw text at x,y
        this.text(txt,x,y);
    };

    API.getLineHeight = function(txt) {
        return this.internal.getLineHeight();
    };

})(jsPDF.API);

(function() {
	"use strict";

	// some variables
	var agency_logo		 = {
			src : 'data:image/jpeg;base64,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',
		},

		footer           = 'KMS - www.kempmanagementsolutions.net',
		page_size        = 'a4',
		page_width       = 210, // mm
		page_margin      = 10,  // mm
		content_width    = page_width - (page_margin * 2), // available width for the content

		_y, _x, // drawing coord
		color_array, _string, lineHeight, y_correction, // some variables

		vspace = 10 // standard vertical space between elements

	;

	// some variables
	var can_display_preview    = true, // if true a preview of the PDF can be displayed in the iframe,
									   // this value is set to false if the browser can't display the preview
		preview_container      = $('#pdf_preview'),
		update_preview_button  = $('#flyer_preview_btn'),
		download_button        = $('#flyer_download_btn')
	;

	// preview can be displayed?
	if (navigator.msSaveBlob) { // older IE
		update_preview_button.prop('disabled', true);
		can_display_preview = false;
		preview_container.replaceWith(
			'<div class="no_iframe">'+
				'<div>'+
					"The preview can't be displayed"+
				'</div>'+
			'</div>'
		);
	}

	// utilities
	var hex2rgb = function ( hex_string ) {
		if( /^#/.test(hex_string)) {
			hex_string = hex_string.substr(1);
		}
		if(hex_string.length === 3 ) {
			hex_string = hex_string.replace(/\w/, function(match) {
		        return String(match) + String(match);
		    });
		}

		return {
			red      : parseInt(hex_string.substr(0, 2), 16),
			green    : parseInt(hex_string.substr(2, 2), 16),
			blue     : parseInt(hex_string.substr(4, 2), 16)
		};
	},

	px2mm = function (pixel) {
		// px to inches
		var inches = pixel / 72;
		return inches * 25.4;
	},

	mm2px = function (millimeters) {
		// mm to inches
		var inches = millimeters / 25.4;
		return inches * 72;
	},

	// function to calculate and check img sizes
	imgSizes = function (img_w, img_h, img_mm_w) {
		/*
			img_w and img_h represent the original image size, in pixel
			img_mm_w is the desidered rendered image size, in millimeters

		*/

		if( img_mm_w > content_width ) { // this should be never used...
			img_mm_w = content_width;
		}

		if(mm2px (img_mm_w) > img_w ) {
			throw 'The `img_mm_w` parameter is too big';
		}

		var img_mm_h = Math.round( (px2mm(img_h) * img_mm_w) / px2mm(img_w) );

		return {
			w            : img_mm_w,
			h            : img_mm_h,
			centered_x   : (page_width - img_mm_w) / 2
		};
	};

	try {

		//Client Logo Check
		var flyer_img = $('#flyer-image'),
			img_data = null
		;

		$('#flyer-image').change(function () {

			// temporary disabling buttons while parsing image
			update_preview_button.prop('disabled', true);
			download_button.prop('disabled', true);

			var user_file = flyer_img[0].files[0];

			img_data = {
				type: user_file.type === 'image/jpeg' ? 'JPEG' : 'PNG' // maybe you should add some controls to prevent loading of other file types
			};

			var reader = new FileReader();
			reader.onload = function(event){
				img_data.src = event.target.result;

				// we need this to get img dimensions
				var user_img = new Image();
				user_img.onload = function () {
					img_data.w = user_img.width;
					img_data.h = user_img.height;

					// restoring buttons
					download_button.prop('disabled', false);
					if(can_display_preview) { update_preview_button.prop('disabled', false); }
				};
				user_img.src = img_data.src;
			};

			//when the file is read it triggers the onload event above.
			reader.readAsDataURL(user_file);
		});

		//Quality Image 1 Check
        var q1_img = $('#flyer-quality1'),
            q1_data = null
        ;

        $('#flyer-quality1').change(function () {

            var q1_file = q1_img[0].files[0];

            q1_data = {
                type: q1_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q1_reader = new FileReader();
            q1_reader.onload = function(event){
            q1_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q1_reader.readAsDataURL(q1_file);
    	});

		//Quality Image 2 Check
        var q2_img = $('#flyer-quality2'),
            q2_data = null
        ;

        $('#flyer-quality2').change(function () {

            var q2_file = q2_img[0].files[0];

            q2_data = {
                type: q2_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q2_reader = new FileReader();
            q2_reader.onload = function(event){
            q2_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q2_reader.readAsDataURL(q2_file);
        });

		//Quality Image 3 Check
        var q3_img = $('#flyer-quality3'),
            q3_data = null
        ;

        $('#flyer-quality3').change(function () {

            var q3_file = q3_img[0].files[0];

            q3_data = {
                type: q3_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q3_reader = new FileReader();
            q3_reader.onload = function(event){
            q3_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q3_reader.readAsDataURL(q3_file);
        });

		//Quality Image 4 Check
        var q4_img = $('#flyer-quality4'),
            q4_data = null
        ;

        $('#flyer-quality4').change(function () {

            var q4_file = q4_img[0].files[0];

            q4_data = {
                type: q4_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q4_reader = new FileReader();
            q4_reader.onload = function(event){
            q4_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q4_reader.readAsDataURL(q4_file);
        });

		//Quality Image 5 Check
        var q5_img = $('#flyer-quality5'),
            q5_data = null
        ;

        $('#flyer-quality5').change(function () {

            var q5_file = q5_img[0].files[0];

            q5_data = {
                type: q5_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q5_reader = new FileReader();
            q5_reader.onload = function(event){
            q5_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q5_reader.readAsDataURL(q5_file);
        });

        //Quality Image 6 Check
        var q6_img = $('#flyer-quality6'),
            q6_data = null
        ;

        $('#flyer-quality6').change(function () {

            var q6_file = q6_img[0].files[0];

            q6_data = {
                type: q6_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q6_reader = new FileReader();
            q6_reader.onload = function(event){
            q6_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q6_reader.readAsDataURL(q6_file);
        });

        //Quality Image 7 Check
        var q7_img = $('#flyer-quality7'),
            q7_data = null
        ;

        $('#flyer-quality7').change(function () {

            var q7_file = q7_img[0].files[0];

            q7_data = {
                type: q7_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q7_reader = new FileReader();
            q7_reader.onload = function(event){
            q7_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q7_reader.readAsDataURL(q7_file);
        });

        //Quality Image 8 Check
        var q8_img = $('#flyer-quality8'),
            q8_data = null
        ;

        $('#flyer-quality8').change(function () {

            var q8_file = q8_img[0].files[0];

            q8_data = {
                type: q8_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var q8_reader = new FileReader();
            q8_reader.onload = function(event){
            q8_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            q8_reader.readAsDataURL(q8_file);
        });

        //Construction Image 1 Check
        var C1_img = $('#flyer-construction1'),
            C1_data = null
        ;

        $('#flyer-construction1').change(function () {

            var C1_file = C1_img[0].files[0];

            C1_data = {
                type: C1_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C1_reader = new FileReader();
            C1_reader.onload = function(event){
            C1_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C1_reader.readAsDataURL(C1_file);
        });

        //Construction Image 2 Check
        var C2_img = $('#flyer-construction2'),
            C2_data = null
        ;

        $('#flyer-construction2').change(function () {

            var C2_file = C2_img[0].files[0];

            C2_data = {
                type: C2_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C2_reader = new FileReader();
            C2_reader.onload = function(event){
            C2_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C2_reader.readAsDataURL(C2_file);
        });

        //Construction Image 3 Check
        var C3_img = $('#flyer-construction3'),
            C3_data = null
        ;

        $('#flyer-construction3').change(function () {

            var C3_file = C3_img[0].files[0];

            C3_data = {
                type: C3_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C3_reader = new FileReader();
            C3_reader.onload = function(event){
            C3_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C3_reader.readAsDataURL(C3_file);
        });

        //Construction Image 4 Check
        var C4_img = $('#flyer-construction4'),
            C4_data = null
        ;

        $('#flyer-construction4').change(function () {

            var C4_file = C4_img[0].files[0];

            C4_data = {
                type: C4_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C4_reader = new FileReader();
            C4_reader.onload = function(event){
            C4_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C4_reader.readAsDataURL(C4_file);
        });

        //Construction Image 5 Check
        var C5_img = $('#flyer-construction5'),
            C5_data = null
        ;

        $('#flyer-construction5').change(function () {

            var C5_file = C5_img[0].files[0];

            C5_data = {
                type: C5_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C5_reader = new FileReader();
            C5_reader.onload = function(event){
            C5_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C5_reader.readAsDataURL(C5_file);
        });

        //Construction Image 6 Check
        var C6_img = $('#flyer-construction6'),
            C6_data = null
        ;

        $('#flyer-construction6').change(function () {

            var C6_file = C6_img[0].files[0];

            C6_data = {
                type: C6_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C6_reader = new FileReader();
            C6_reader.onload = function(event){
            C6_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C6_reader.readAsDataURL(C6_file);
        });

        //Construction Image 7 Check
        var C7_img = $('#flyer-construction7'),
            C7_data = null
        ;

        $('#flyer-construction7').change(function () {

            var C7_file = C7_img[0].files[0];

            C7_data = {
                type: C7_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C7_reader = new FileReader();
            C7_reader.onload = function(event){
            C7_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C7_reader.readAsDataURL(C7_file);
        });

        //Construction Image 8 Check
        var C8_img = $('#flyer-construction8'),
            C8_data = null
        ;

        $('#flyer-construction8').change(function () {

            var C8_file = C8_img[0].files[0];

            C8_data = {
                type: C8_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C8_reader = new FileReader();
            C8_reader.onload = function(event){
            C8_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C8_reader.readAsDataURL(C8_file);
        });

        //Construction Image 9 Check
        var C9_img = $('#flyer-construction9'),
            C9_data = null
        ;

        $('#flyer-construction9').change(function () {

            var C9_file = C9_img[0].files[0];

            C9_data = {
                type: C9_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C9_reader = new FileReader();
            C9_reader.onload = function(event){
            C9_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C9_reader.readAsDataURL(C9_file);
        });

        //Construction Image 10 Check
        var C10_img = $('#flyer-construction10'),
            C10_data = null
        ;

        $('#flyer-construction10').change(function () {

            var C10_file = C10_img[0].files[0];

            C10_data = {
                type: C10_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C10_reader = new FileReader();
            C10_reader.onload = function(event){
            C10_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C10_reader.readAsDataURL(C10_file);
        });

        //Construction Image 11 Check
        var C11_img = $('#flyer-construction11'),
            C11_data = null
        ;

        $('#flyer-construction11').change(function () {

            var C11_file = C11_img[0].files[0];

            C11_data = {
                type: C11_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C11_reader = new FileReader();
            C11_reader.onload = function(event){
            C11_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C11_reader.readAsDataURL(C11_file);
        });

        //Construction Image 12 Check
        var C12_img = $('#flyer-construction12'),
            C12_data = null
        ;

        $('#flyer-construction12').change(function () {

            var C12_file = C12_img[0].files[0];

            C12_data = {
                type: C12_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C12_reader = new FileReader();
            C12_reader.onload = function(event){
            C12_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C12_reader.readAsDataURL(C12_file);
        });

        //Construction Image 13 Check
        var C13_img = $('#flyer-construction13'),
            C13_data = null
        ;

        $('#flyer-construction13').change(function () {

            var C13_file = C13_img[0].files[0];

            C13_data = {
                type: C13_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C13_reader = new FileReader();
            C13_reader.onload = function(event){
            C13_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C13_reader.readAsDataURL(C13_file);
        });

        //Construction Image 14 Check
        var C14_img = $('#flyer-construction14'),
            C14_data = null
        ;

        $('#flyer-construction14').change(function () {

            var C14_file = C14_img[0].files[0];

            C14_data = {
                type: C14_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C14_reader = new FileReader();
            C14_reader.onload = function(event){
            C14_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C14_reader.readAsDataURL(C14_file);
        });

        //Construction Image 15 Check
        var C15_img = $('#flyer-construction15'),
            C15_data = null
        ;

        $('#flyer-construction15').change(function () {

            var C15_file = C15_img[0].files[0];

            C15_data = {
                type: C15_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C15_reader = new FileReader();
            C15_reader.onload = function(event){
            C15_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C15_reader.readAsDataURL(C15_file);
        });

        //Construction Image 16 Check
        var C16_img = $('#flyer-construction16'),
            C16_data = null
        ;

        $('#flyer-construction16').change(function () {

            var C16_file = C16_img[0].files[0];

            C16_data = {
                type: C16_file.type === 'image/jpeg' ? 'JPEG' : 'PNG'
            };

            var C16_reader = new FileReader();
            C16_reader.onload = function(event){
            C16_data.src = event.target.result;
            };

            //when the file is read it triggers the onload event above.
            C16_reader.readAsDataURL(C16_file);
        });

		//!pdf builder
		var createPDF = function (update_preview) {

			_y = page_margin; // vertical starting point

			// form data
			var flyer_title             = $('#client_name').val(),
				flyer_title_size        = 20,
				flyer_description       = $('#flyer-description').val(),
				flyer_price_color       = '#8fe9ea',

				//Our variables
				flyer_quality			=$('#flyer-quality').val(),
				flyer_quality1			=$('#flyer-quality1').val(),
				flyer_quality2			=$('#flyer-quality2').val(),
				flyer_quality3			=$('#flyer-quality3').val(),
				flyer_quality4			=$('#flyer-quality4').val(),
				flyer_quality5			=$('#flyer-quality5').val(),
				flyer_quality6			=$('#flyer-quality6').val(),
				flyer_quality7			=$('#flyer-quality7').val(),
				flyer_quality8			=$('#flyer-quality8').val(),
				q1_caption				=$('#Q1_c').val(),
				q2_caption				=$('#Q2_c').val(),
				q3_caption				=$('#Q3_c').val(),
				q4_caption				=$('#Q4_c').val(),
				q5_caption				=$('#Q5_c').val(),
				q6_caption				=$('#Q6_c').val(),
				q7_caption				=$('#Q7_c').val(),
				q8_caption				=$('#Q8_c').val(),
				flyer_quality_notes		=$('#flyer-quality-notes').val(),

                flyer_construction1     =$('#flyer-construction1').val(),
                flyer_construction2     =$('#flyer-construction2').val(),
                flyer_construction3     =$('#flyer-construction3').val(),
                flyer_construction4     =$('#flyer-construction4').val(),
                flyer_construction5     =$('#flyer-construction5').val(),
                flyer_construction6     =$('#flyer-construction6').val(),
                flyer_construction7     =$('#flyer-construction7').val(),
                flyer_construction8     =$('#flyer-construction8').val(),
                flyer_construction9     =$('#flyer-construction9').val(),
                flyer_construction10     =$('#flyer-construction10').val(),
                flyer_construction11     =$('#flyer-construction11').val(),
                flyer_construction12     =$('#flyer-construction12').val(),
                flyer_construction13     =$('#flyer-construction13').val(),
                flyer_construction14     =$('#flyer-construction14').val(),
                flyer_construction15     =$('#flyer-construction15').val(),
                flyer_construction16     =$('#flyer-construction16').val(),
                C1_caption              =$('#C1_c').val(),
                C2_caption              =$('#C2_c').val(),
                C3_caption              =$('#C3_c').val(),
                C4_caption              =$('#C4_c').val(),
                C5_caption              =$('#C5_c').val(),
                C6_caption              =$('#C6_c').val(),
                C7_caption              =$('#C7_c').val(),
                C8_caption              =$('#C8_c').val(),
                C9_caption              =$('#C9_c').val(),
                C10_caption             =$('#C10_c').val(),
                C11_caption             =$('#C11_c').val(),
                C12_caption             =$('#C12_c').val(),
                C13_caption             =$('#C13_c').val(),
                C14_caption             =$('#C14_c').val(),
                C15_caption             =$('#C15_c').val(),
                C16_caption             =$('#C16_c').val(),
                flyer_construction_extra=$('#flyer-construction-extra').val(),

				test_table				=$("#table")[0],
				logo_data 				= {w : 15, h : 25, x : 185, y : 10};
			;

			var pdf = new jsPDF('p', 'mm', page_size),
				text_baseline,

				// some colors:
				light_grey = 237,
				grey       = 128,
				black      = 0,
				white 	   = 255
			;

			function makeHeader(text) {
				_y = 0;
				pdf.setTextColor(black);
				pdf.setFontSize(flyer_title_size);
				pdf.setFontType("bold");

				lineHeight = px2mm(pdf.getLineHeight(flyer_title));
				_y += (vspace + lineHeight) + page_margin;

				pdf.textAlign(text, {align: "center"}, 0, _y);
				pdf.addImage(agency_logo.src, 'JPG', logo_data.x, logo_data.y, logo_data.w, logo_data.h);
			};

			function makeFooter() {
				pdf.setFontSize(9);
				pdf.setFontType("normal");
				pdf.setTextColor(black);
				pdf.textAlign(footer, {align: "center"}, 0, 287);
			};

			function makeCaption(text, xpos, ypos) {
				pdf.setFontSize(10);
				pdf.setFont("helvetica");
				pdf.setFontType("normal");
				pdf.setTextColor(black);

				var lineWidth = 95;

				var line_height = 5; // mm

				var caption_lines = pdf.splitTextToSize(text, lineWidth);

				for (var i = 0 ; i < caption_lines.length ; i++ ) {
					pdf.text(xpos, ypos, caption_lines[i]);
					ypos += line_height;
				}

				pdf.setFontSize(12);
			};

			function makeQualityNotes(ypos) {
				pdf.setFontSize(12);
				pdf.setFont("helvetica");
				pdf.setFontType("normal");
				pdf.setTextColor(black);

				var lineWidth = 190;

				var line_height = 7; // mm

				var qnote_lines = pdf.splitTextToSize('     ' + flyer_quality_notes, lineWidth);

				for (var i = 0 ; i < qnote_lines.length ; i++ ) {
					pdf.text(page_margin, ypos, qnote_lines[i]);
					ypos += line_height;
				}
			};

			// Optional - set properties of the document
			pdf.setProperties({
				title   : flyer_title,
				subject : footer,
				author  : 'me',
				creator : 'jsPDF'
			});

			// !kmslogo
			pdf.addImage(agency_logo.src, 'JPG', logo_data.x, logo_data.y, logo_data.w, logo_data.h);

			// !clientlogo
			if(img_data) {
				var img_sizes = imgSizes (img_data.w, img_data.h, content_width);
				pdf.addImage(img_data.src, img_data.type, 10, 10, 50, 15);

			} else {
				pdf.setFillColor(light_grey);
				pdf.roundedRect(10, 10, 50, 15, 1, 1, 'F');
				
				_string = 'No Logo';

				pdf.setFontSize(20);
				pdf.setFont("helvetica");
				pdf.setFontType("bold");

				lineHeight = px2mm(pdf.getLineHeight(_string));
				y_correction = lineHeight/3;

				pdf.setTextColor(white);
				pdf.textAlign(_string, {align: "centerAtX"}, 35, 17 + y_correction );
			}

			// fonts initializing
			pdf.setFont("helvetica");
			pdf.setFontType("bold");

			// Get radio  and time values
			var frequency = document.querySelector('input[name="freq"]:checked').value;
			var date = new Date();
			var gen_date = date.getMonth() + 1 + "/" + date.getDate() + "/" + date.getFullYear();

			// !Header
			pdf.setTextColor(black);
			pdf.setFontSize(15);
			pdf.textAlign(flyer_title, {align: "center"}, 0, _y += 5);
			pdf.textAlign(frequency + ' Project Summary Report', {align: "center"}, 0, _y += 5);
			pdf.textAlign(gen_date, {align: "center"}, 0, _y += 5);

			// !Execuve Summary Header
			pdf.setTextColor(black);
			pdf.setFontSize(flyer_title_size);
			pdf.setFont("helvetica");
			pdf.setFontType("bold");

			lineHeight = px2mm(pdf.getLineHeight(flyer_title));
			_y = 45;

			pdf.textAlign('Executive Summary', {align: "center"}, 0, _y);

			// !description / executive summary
			if(flyer_description) {
				pdf.setFontSize(12);
				pdf.setFont("helvetica");
				pdf.setFontType("normal");
				pdf.setTextColor(black);

				var lineWidth = 190;
				_y += page_margin;

				var line_height = 7; // mm

				var description_lines = pdf.splitTextToSize('     ' + flyer_description, lineWidth);

				for (var i = 0 ; i < description_lines.length ; i++ ) {
					pdf.text(page_margin, _y, description_lines[i]);
					_y += line_height;
				}
			}

			// !Schedule Recap Header
			_y = _y - line_height;
			pdf.setFontSize(flyer_title_size);
			pdf.setFontType("bold");

			lineHeight = px2mm(pdf.getLineHeight(flyer_title));
			_y += (vspace + lineHeight);

			pdf.textAlign('Schedule Recap', {align: "center"}, 0, _y);

			makeFooter();
			pdf.addPage(); //Page 2

			// !Quality
			makeHeader('Quality');

			if (flyer_quality) {
				pdf.setFontSize(12);
				pdf.setFont("helvetica");
				pdf.setFontType("normal");
				pdf.setTextColor(black);

				lineWidth = 190;
				_y = 45;
				line_height = 7; // mm
				var quality_lines = pdf.splitTextToSize('     ' + flyer_quality, lineWidth);

				for (var i = 0 ; i < quality_lines.length ; i++ ) {
					pdf.text(page_margin, _y, quality_lines[i]);
					_y += line_height;
				}
			}

			// !Universal content image sizes
			var content_img_w = 94;
			var content_img_h = 65;

			if(_y > 287 - content_img_h) {
				pdf.addPage();
				_y = 0;
				pdf.setFontSize(flyer_title_size);
				pdf.setFontType("bold");
				lineHeight = px2mm(pdf.getLineHeight(flyer_title));
				_y += (vspace + lineHeight);
				pdf.textAlign('Quality (Continued)', {align: "center"}, 0, _y);
				y += page_margin;
			}

			pdf.setFontSize(10);

			// !Quality Images
			if(q1_data) {
				pdf.addImage(q1_data.src, q1_data.type, 10, _y, content_img_w, content_img_h);
				makeCaption(q1_caption, 10, _y + content_img_h + 5);
			}

			if(q2_data) {
				pdf.addImage(q2_data.src, q2_data.type, 200 - content_img_w, _y, content_img_w, content_img_h);
				makeCaption(q2_caption, 200 - content_img_w, _y + content_img_h + 5);
			}

			if(flyer_quality.length > 970) {
				makeFooter();
				pdf.addPage();
				makeHeader('Quality Continued');
				_y += 10;
			}

			if(q3_data == null) {
				makeQualityNotes(_y + content_img_h + 25);
			}

			if(q3_data) {
                pdf.addImage(q3_data.src, q3_data.type, 10, _y + content_img_h + 20, content_img_w, content_img_h);
				makeCaption(q3_caption, 10, _y + (content_img_h * 2) + 25);
            }

			if(q4_data) {
                pdf.addImage(q4_data.src, q4_data.type, 200 - content_img_w, _y + content_img_h + 20, content_img_w, content_img_h);
				makeCaption(q4_caption, 200 - content_img_w, _y + (content_img_h * 2) + 25);
            }

			if((q3_data) && (q5_data == null) && (flyer_quality.length <= 970)) {
				makeFooter();
				pdf.addPage();
				makeHeader('Quality Continued');
				_y += 10;

				makeQualityNotes(_y);
			}

			if((q3_data) && (q5_data == null) && (flyer_quality.length > 970)) {
				makeQualityNotes(_y + (content_img_h * 2) + 45);
			}

			if(q5_data) {

				if(flyer_quality.length <= 970)
				{
					makeFooter();
					pdf.addPage();
					makeHeader('Quality Continued');
					_y += 10;
				}

				if(q5_data) {
                	pdf.addImage(q5_data.src, q5_data.type, 10, _y, content_img_w, content_img_h);
					makeCaption(q5_caption, 10, _y + content_img_h + 5);
            	}

				if(q6_data) {
                	pdf.addImage(q6_data.src, q6_data.type, 200 - content_img_w, _y, content_img_w, content_img_h);
					makeCaption(q6_caption, 200 - content_img_w, _y + content_img_h + 5);
            	}

				if(q7_data) {
                	pdf.addImage(q7_data.src, q7_data.type, 10, _y + content_img_h + 20, content_img_w, content_img_h);
					makeCaption(q7_caption, 10, _y + (content_img_h * 2) + 25);
            	}

         		if(q8_data) {
                	pdf.addImage(q8_data.src, q8_data.type, 200 - content_img_w, _y + content_img_h + 20, content_img_w, content_img_h);
					makeCaption(q8_caption, 200 - content_img_w, _y + (content_img_h * 2) + 25);
            	}

				if((q5_data) && (q7_data == null))
				{
					_y = _y + content_img_h + 25;
				}

				if(q7_data) {
					_y = _y + (content_img_h * 2) + 45;
				}

				if(flyer_quality_notes) {
					makeQualityNotes(_y)
				}
			}

			makeFooter();
			pdf.addPage(); //Page 3

			// !Test Area
			/*makeHeader('Test Table');

			var table_margins = {top: 35, bottom: 10, left: 10, width: 600};
			pdf.fromHTML(test_table, table_margins.left, table_margins.top, {'width' : table_margins.width}, table_margins);

			makeFooter();
			pdf.addPage(); //Page 4
            */

			// !Payment Summary
			makeHeader('Payment Summary');

			//Table here
			
			makeFooter();
            pdf.addPage();

            // !Cost Summary
			makeHeader('Cost Summary');

			//Table here
			
			makeFooter();
            pdf.addPage();

            // !Construction Progress
            makeHeader('Construction Progress');
            _y += line_height + 3;

            if(C1_data) {
                pdf.addImage(C1_data.src, C1_data.type, 10, _y, content_img_w, content_img_h);
                makeCaption(C1_caption, 10, _y + content_img_h + 5);
            }

            if(C2_data) {
                pdf.addImage(C2_data.src, C2_data.type, 200 - content_img_w, _y, content_img_w, content_img_h);
                makeCaption(C2_caption, 200 - content_img_w, _y + content_img_h + 5);
            }

            if(C3_data) {
                pdf.addImage(C3_data.src, C3_data.type, 10, _y + content_img_h + 25, content_img_w, content_img_h);
                makeCaption(C3_caption, 10, _y + (content_img_h * 2) + 30);
            }

            if(C4_data) {
                pdf.addImage(C4_data.src, C4_data.type, 200 - content_img_w, _y + content_img_h + 25, content_img_w, content_img_h);
                makeCaption(C4_caption, 200 - content_img_w, _y + (content_img_h * 2) + 30);
            }

            if(C5_data == null) {
                _y = _y + (content_img_h * 2) + 50
            }

            if(C5_data) {
                pdf.addImage(C5_data.src, C5_data.type, 10, _y + (content_img_h * 2) + 40, content_img_w, content_img_h);
                makeCaption(C5_caption, 10, _y + (content_img_h * 3) + 45);
            }

            if(C6_data) {
                pdf.addImage(C6_data.src, C6_data.type, 200 - content_img_w, _y + (content_img_h * 2) + 40, content_img_w, content_img_h);
                makeCaption(C6_caption, 200 - content_img_w, _y + (content_img_h * 3) + 45);
            }

            if(C7_data == null) {
                if(flyer_construction_extra) {
                    pdf.textAlign(text, {align: "center"}, 0, _y);
                }
            }

            if(C7_data) {
                pdf.addPage();
            }

			// ****************************
			// output
			if(update_preview) {
				preview_container.attr('src', pdf.output('datauristring') );
			} else {
				pdf.save(frequency + ' ' + flyer_title + '.pdf');
			}

		}; // end createPDF

		// !buttons
        /*
		$('#flyer_quality_btn').click(function () {
			var new_row = document.getElementById('QIMG_extra').style;
			new_row.display = 'inherit';
			document.getElementById("flyer_quality_btn").disabled = true;
		});

		$('#flyer_progress_btn').click(function () {
			//var new_row = document.getElementById('QIMG_extra').style;
			//new_row.display = 'inherit';
			document.getElementById("flyer_progress_btn").disabled = true;
		});
        */
		update_preview_button.click(function () {
			createPDF(true);
		});

		$('#flyer_download_btn').click(function () {
			createPDF(false);
		});

	} catch (e) {
		console.log(e);
	}

})();
</script>